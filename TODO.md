- better error handling.
- less C-ish style.
